---
import DuelistCard from '../components/Cards/DuelistCard.astro';
import YGOCard from '../components/Cards/YGOCard.astro';
import PokemonCard from '../components/Cards/PokemonCard.astro';

const title = 'Ranking';

interface Pokemon {
	name: string;
}

interface YGO {
	id: number;
}

interface Duelist {
	userId: number;
	username: string;
	points: number;
	wins: number;
	losses: number;
	winRate: number;
	position: number;
}

// POKEMON API
const pokemonResponse = await fetch('https://pokeapi.co/api/v2/pokemon?limit=12');
const pokemonData = await pokemonResponse.json();
const pokemons = pokemonData.results;

// YGO API
const ygoCardIds = [
	11714098, 68170903, 27744077, 23771716, 34541863, 64163367, 26593852, 19204398, 5405694,
	65393205, 3366982, 3544583,
];
const ygoResponse = await fetch(
	`https://db.ygoprodeck.com/api/v7/cardinfo.php?id=${ygoCardIds.join(',')}`,
);
const ygoData = await ygoResponse.json();
const ygocards = ygoData.data;

// DUELIST API
const duelistResponse = await fetch(
	`${import.meta.env.PUBLIC_API_URL}/stats/?page=1&limit=12&banListName=Global`,
);
const duelistData = await duelistResponse.json();
const duelists = duelistData;
---

<ul role='list' class='link-card-grid' id='section-ranking'>
	{duelists.map((duelist: Duelist) => <DuelistCard {...duelist} />)}
	{ygocards.map((ygocard: YGO) => <YGOCard id={ygocard.id} />)}
	{pokemons.map((pokemon: Pokemon) => <PokemonCard name={pokemon.name} />)}
</ul>

<style>
	.link-card-grid {
		display: grid;
		grid-template-columns: repeat(auto-fit, minmax(24ch, 1fr));
		gap: 2rem;
		padding: 0;
		margin-top: 2rem;
	}
</style>
